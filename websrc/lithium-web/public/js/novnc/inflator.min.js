import{inflateInit,inflate,inflateReset}from"/js/novnc/vendor/pako/lib/zlib/inflate.min.js";import ZStream from"/js/novnc/vendor/pako/lib/zlib/zstream.min.js";export default class Inflate{constructor(){this.strm=new ZStream,this.chunkSize=102400,this.strm.output=new Uint8Array(this.chunkSize),this.windowBits=5,inflateInit(this.strm,this.windowBits)}setInput(data){data?(this.strm.input=data,this.strm.avail_in=this.strm.input.length,this.strm.next_in=0):(this.strm.input=null,this.strm.avail_in=0,this.strm.next_in=0)}inflate(expected){let ret;if(expected>this.chunkSize&&(this.chunkSize=expected,this.strm.output=new Uint8Array(this.chunkSize)),this.strm.next_out=0,this.strm.avail_out=expected,inflate(this.strm,0)<0)throw new Error("zlib inflate failed");if(this.strm.next_out!=expected)throw new Error("Incomplete zlib block");return new Uint8Array(this.strm.output.buffer,0,this.strm.next_out)}reset(){inflateReset(this.strm)}}
